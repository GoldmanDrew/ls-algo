ibkr:
  host: 127.0.0.1
  port: 7496
  client_id: 41 #change to 41 for live
  prefer_delayed: true
strategy:
  tag: ETF_LS
  capital_usd: 275000
  gross_leverage: 4
  blacklist:
  - JPM
  - BRK-B
  - AXP
  beta_cutoff: 1.5          # new: cutoff for |Beta|
  beta_split_high: 1.0     # new: within leveraged sleeve, fraction to |Beta| > cutoff
paths:
  screened_csv: data/etf_screened_today.csv
  blacklist_txt: config/strategy_blacklist.txt
  baseline_csv: data/baseline_snapshot.csv
  proposed_trades_csv: data/proposed_trades.csv
  ledger_csv: data/strategy_ledger.csv
  fills_csv: data/trade_fills.csv

  # NEW: weekly flow overlay
  flow_targets_csv: data/flow_targets.csv
  flow_ledger_csv: data/flow_ledger.csv
execution:
  # Parallelism
  parallel_n: 25       # 1 = serial, 5-20 = parallel buckets
  auto_approve: true   # must be true for parallel execution (no interactive prompts)

  # Use no-price orders
  order_style: ADAPTIVE_MKT   # options: ADAPTIVE_MKT, MKT, LMT
  dry_run: false
  limit_bps: 25.0
  aggressive_bps_step: 50.0
  market_fallback_third_try: true
  short_first: true
  max_retries: 3
  timeout_sec: 90
  accept_timeout_sec: 20
  market_accept_timeout_sec: 90
  limit_done_timeout_sec: 90
  market_done_timeout_sec: 180

screener:
  borrow_low: 0.08           # 8% low-end threshold (decimal)
  purgatory_margin: 0.04     # +4% band above BORROW_LOW (decimal)
  whitelist_hard_borrow_cap: 0.25
  flow_hard_borrow_cap: 0.25
portfolio:
  sleeves:
    core_leveraged:
      allocation_type: "stock"
      target_weight: 0.85
      rules:
        min_beta_used: 1.50
      weighting:
        method: "equal"
        max_name_weight: 0.05
        min_names: 10
    whitelist_stock:
      allocation_type: "stock"
      target_weight: 0.15
      universe:
        etfs:
          - MTYY
          - MAAY
          - FBYY
          - XBTY
          - NFLW
          - HOOW
          - MARO
          - MSFW
          - PLTW
          - MSTW
      weighting:
        method: "zipf"
        zipf_exponent: 1.0
        rank_order: "as_listed"
        caps:
          max_name_weight: 0.20
    flow_program:
      allocation_type: "flow"
      frequency: "D"
      deployment_base: "fixed_usd_per_day"
      fixed_usd_per_day: 650
      universe:
        shorts:
          - SDS
          - EWV
          - SQQQ
          - TQQY
          - LABD
          - SOXS
          - FAZ
          - DUST
          - ZSL
          - TSLQ
          - TSYY
          - NVDQ
          - NVYY
      weighting:
        method: "fixed"
        normalize: true
        weights:
          SDS: 0.22
          EWV: 0.18
          SQQQ: 0.15
          TQQY: 0.07
          LABD: 0.08
          SOXS: 0.05
          FAZ: 0.08
          DUST: 0.03
          ZSL: 0.01
          TSLQ: 0.04
          TSYY: 0.02
          NVDQ: 0.04
          NVYY: 0.03
